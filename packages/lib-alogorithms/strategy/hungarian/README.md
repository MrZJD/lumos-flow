# Hungarian 匈牙利算法

> 用于解决分配问题

* [wikipike](https://zh.wikipedia.org/wiki/%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95)
* [算法讲解](https://blog.csdn.net/wangzhenyang2/article/details/114933806)

## 问题场景

1. 五位员工E1~E5,五种项任务M1~M5,每个员工完成任务都需要不同的成本，成本系数为n1~n5,请分配任务使完成成本最小(一位员工完成一项任务)

2. 一位用户，有n种类型的优惠券，每一张可以使价格-x，请计算使用优惠券的组合使价格最低

## SOP

1. 构造数据矩阵

```ts
const rawData = [
  [E1n1, E2n1, E3n1, E4n1, E5n1], // 每位员工完成n1任务的成本
  [E1n2, E2n2, E3n2, E4n2, E5n2], // 每位员工完成n2任务的成本
  // ...
];

const rawExData = [
  [10, 5, 9, 18, 11],
  [13, 19, 6, 12, 14],
  [3, 2, 4, 4, 5],
  [18, 9, 12, 17, 15],
  [11, 6, 14, 19, 10]
];
```

2. 若将分配问题的系数矩阵每一行及每一列分别减去各行及各列的最小元素，则新的分配问题与原分配问题有相同的最优解，只是最优值差一个常数。

```ts
//// ------> -x
const optExData = [
  [5, 0, 4, 13, 6],
  [7, 13, 0, 6, 8],
  [1, 0, 2, 2, 3],
  [9, 0, 3, 8, 6],
  [5, 0, 8, 13, 4]
];

//// ------> -y
const opt2ExData = [
  [4, 0, 4, 11, 3],
  [6, 13, 0, 4, 5],
  [0, 0, 2, 0, 0],
  [8, 0, 3, 6, 3],
  [4, 0, 8, 11, 1]
];
```

3. 序列化矩阵

```ts
//// 独立0元素: 所在的行或列只有自己一个0元素的元素
//// 3.1 用1标记0,0标记非0, 用2标注独立0元素,-2表示划掉的0元素

// ---> base
const base = [
  [0, 1, 0, 0, 0],
  [0, 0, 1, 0, 0],
  [1, 1, 0, 1, 1],
  [0, 1, 0, 0, 0],
  [0, 1, 0, 0, 0]
];
// ---> loop1
const l1 = [
  [0, 2, 0, 0, 0],
  [0, 0, 2, 0, 0],
  [2, -2, 0, -2, -2],
  [0, -2, 0, 0, 0],
  [0, -2, 0, 0, 0]
];
```

4. 盖0线

```ts
//// ---> 4.1 找到不含独立0元素的行
const r1 = 4 // 5
//// ---> 4.2 上一步行中，划掉0所在的列
const r2 = 2 // 2
//// ---> 4.3 上一步列中，独立0所在的行
const r3 = 1 // 1

//// ---> loop 4.2 / 4.3 直到无法继续
//// ---> 4.4 在所有标注的列 和 未被标注的行做盖0线，用3标记
const result = [
  [0, 3, 0, 0, 0],
  [3, 3, 3, 3, 3],
  [3, 3, 3, 3, 3],
  [0, 3, 0, 0, 0],
  [0, 3, 0, 0, 0]
]; // 盖0线数量 = 3
```

5. 更新系数矩阵

```ts
const raw = [
  [4, 0, 4, 11, 3],
  [6, 13, 0, 4, 5],
  [0, 0, 2, 0, 0],
  [8, 0, 3, 6, 3],
  [4, 0, 8, 11, 1]
];
//// 5.1 找到未被盖0线覆盖的元素中的最小值
const min = 1;
//// 5.2 所有未被盖0线覆盖的元素减去最小值
const result1 = [
  [3, 0, 3, 10, 2],
  [6, 13, 0, 4, 5],
  [0, 0, 2, 0, 0],
  [7, 0, 2, 5, 2],
  [3, 0, 7, 10, 0]
];
//// 5.3 所有盖0线交叉处的元素值加上最小值
const result2 = [
  [3, 0, 3, 10, 2],
  [6, 14, 0, 4, 5],
  [0, 1, 2, 0, 0],
  [7, 0, 2, 5, 2],
  [3, 0, 7, 10, 0]
];
```
